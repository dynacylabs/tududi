/**
 * PWA-specific styles for mobile devices
 * Handles safe areas for iOS notches and proper fullscreen display
 */

/* iOS Safe Area Support */
:root {
  /* Define safe area insets for iOS notches */
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
}

/* Apply safe area padding to body when running as PWA */
@media all and (display-mode: standalone),
       all and (display-mode: fullscreen) {
  
  /* Ensure body respects safe areas */
  body {
    padding-top: var(--safe-area-inset-top);
    padding-right: var(--safe-area-inset-right);
    padding-bottom: var(--safe-area-inset-bottom);
    padding-left: var(--safe-area-inset-left);
  }
  
  /* Prevent content from being hidden behind notch/home indicator */
  #root {
    min-height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  }
  
  /* Adjust fixed elements for safe areas */
  .fixed-header,
  header {
    padding-top: max(1rem, var(--safe-area-inset-top));
  }
  
  .fixed-footer,
  footer {
    padding-bottom: max(1rem, var(--safe-area-inset-bottom));
  }
  
  /* Fullscreen mode optimizations */
  @media (display-mode: fullscreen) {
    /* Hide any browser chrome elements */
    ::-webkit-scrollbar {
      width: 0;
      height: 0;
    }
    
    /* Optimize touch targets for fullscreen */
    button,
    a,
    input,
    select,
    textarea {
      min-height: 44px; /* iOS recommended touch target size */
      min-width: 44px;
    }
  }
}

/* PWA Install Prompt Styling */
.pwa-install-prompt {
  position: fixed;
  bottom: var(--safe-area-inset-bottom, 0);
  left: 0;
  right: 0;
  background: rgba(0, 0, 0, 0.9);
  color: white;
  padding: 1rem;
  padding-bottom: calc(1rem + var(--safe-area-inset-bottom, 0));
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 1000;
  transform: translateY(100%);
  transition: transform 0.3s ease-in-out;
}

.pwa-install-prompt.show {
  transform: translateY(0);
}

/* Prevent pull-to-refresh on iOS when running as PWA */
@media all and (display-mode: standalone) {
  body {
    overscroll-behavior-y: contain;
  }
}

/* Android-specific PWA styles */
@media (hover: none) and (pointer: coarse) {
  /* Touch device optimizations */
  * {
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Larger touch targets */
  button:not(.btn-sm),
  a:not(.text-link) {
    padding: 0.75rem 1rem;
  }
}

/* Splash screen style (for iOS) */
@media (display-mode: standalone) {
  /* Hide splash screen after app loads */
  .splash-screen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-color, #ffffff);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity 0.3s ease-out;
  }
  
  .splash-screen.hidden {
    opacity: 0;
    pointer-events: none;
  }
}

/* Status bar overlay for iOS */
@supports (padding-top: env(safe-area-inset-top)) {
  .status-bar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--safe-area-inset-top);
    background: var(--bg-color, #ffffff);
    z-index: 1000;
  }
}

/* Viewport height fix for mobile browsers */
.full-height {
  height: 100vh;
  height: -webkit-fill-available;
  min-height: -webkit-fill-available;
}

/* PWA-specific dark mode adjustments */
@media (prefers-color-scheme: dark) {
  @media (display-mode: standalone) {
    /* Darker background for true black on OLED screens */
    body {
      background-color: #000000;
    }
    
    .status-bar-overlay {
      background: #000000;
    }
  }
}
